// obj.js | Unobtrusive object subscribe
// https://github.com/Daniel-Hug/object-subscribe

(function(g,e){"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?module.exports=e():g.Obj=e()})(this,function(){function g(a){for(var d=0,b=e.length;d<b;d++)if(e[d][0]===a)return d;return-1}var e=[],c={has:function(a,d){return c.hasOwnProperty.call(a,d)}};c.keys=Object.keys||function(a){var d=[],b;for(b in a)c.has(a,b)&&d.push(b);return d};c.type=function(a){return c.toString.call(a).slice(8,-1).toLowerCase()};c.extend=function(a,d){if(null==a||"object"!==typeof a)return a;d=d||("array"===c.type(a)?[]:{});for(var b in a)c.has(a,b)&&(d[b]=c.extend(a[b]));return d};c.subscribe=function(a,d,b){var c=g(a);0<=c?e[c][1].push(d):e.push([a,[d]]);b&&d(a)};c.unsubscribe=function(a,d){var b=g(a),c;if(0<=b)if(d){if((b=e[b][1])&&b.length)for(c=d.length;c--;)b.splice(b.indexOf(d[c]),1)}else e.splice(b,1)};c.set=function(a,d,b){if(b)var e=c.extend(a);for(var f in d)c.has(d,f)&&(a[f]=d[f]);b&&c.changed(a,e)};c.unset=function(a,d,b){if(b)var e=c.extend(a);for(var f=d.length;f--;)delete a[d[f]];b&&c.changed(a,e)};c.reset=function(a,d,b){if(b)var e=c.extend(a);for(var f in a)c.has(a,f)&&delete a[f];c.set(a,d,1);b&&c.changed(a,e)};c.changed=function(a,d){var b=g(a);if(0<=b)for(var b=e[b][1],c=b.length,f=0;f<c;f++)b[f](a,d)};return c});
